<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Incertidumbre de una calibración no lineal con aplicación en química analítica</title>

  <meta property="description" itemprop="description" content="Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-06-06"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-06-06"/>
  <meta name="article:author" content="Carlos Gomez"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Incertidumbre de una calibración no lineal con aplicación en química analítica"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Incertidumbre de una calibración no lineal con aplicación en química analítica"/>
  <meta property="twitter:description" content="Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Incertidumbre de una calibración no lineal con aplicación en química analítica"]},{"type":"character","attributes":{},"value":["Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Carlos Gomez"]},{"type":"character","attributes":{},"value":["https://www.analytical.cl"]}]}]},{"type":"character","attributes":{},"value":["2020-06-06"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["incertidumbre-no-lineal_files/anchor-4.2.2/anchor.min.js","incertidumbre-no-lineal_files/bowser-1.9.3/bowser.min.js","incertidumbre-no-lineal_files/distill-2.2.21/template.v2.js","incertidumbre-no-lineal_files/figure-html5/fit.lin.res-1.png","incertidumbre-no-lineal_files/figure-html5/patch-1.png","incertidumbre-no-lineal_files/figure-html5/plot.lineal-1.png","incertidumbre-no-lineal_files/figure-html5/plot.nolineal-1.png","incertidumbre-no-lineal_files/figure-html5/plot.u.MC-1.png","incertidumbre-no-lineal_files/figure-html5/u.vs.con-1.png","incertidumbre-no-lineal_files/figure-html5/unnamed-chunk-1-1.png","incertidumbre-no-lineal_files/figure-html5/unnamed-chunk-5-1.png","incertidumbre-no-lineal_files/header-attrs-2.7.3/header-attrs.js","incertidumbre-no-lineal_files/jquery-1.11.3/jquery.min.js","incertidumbre-no-lineal_files/popper-2.6.0/popper.min.js","incertidumbre-no-lineal_files/tippy-6.2.7/tippy-bundle.umd.min.js","incertidumbre-no-lineal_files/tippy-6.2.7/tippy-light-border.css","incertidumbre-no-lineal_files/tippy-6.2.7/tippy.css","incertidumbre-no-lineal_files/tippy-6.2.7/tippy.umd.min.js","incertidumbre-no-lineal_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="incertidumbre-no-lineal_files/header-attrs-2.7.3/header-attrs.js"></script>
  <script src="incertidumbre-no-lineal_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="incertidumbre-no-lineal_files/popper-2.6.0/popper.min.js"></script>
  <link href="incertidumbre-no-lineal_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="incertidumbre-no-lineal_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="incertidumbre-no-lineal_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="incertidumbre-no-lineal_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="incertidumbre-no-lineal_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="incertidumbre-no-lineal_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="incertidumbre-no-lineal_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Incertidumbre de una calibración no lineal con aplicación en química analítica","description":"Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo","authors":[{"author":"Carlos Gomez","authorURL":"https://www.analytical.cl","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-06-06T00:00:00.000-04:00","citationText":"Gomez, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Incertidumbre de una calibración no lineal con aplicación en química analítica</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Se comparan tres métodos para estimar la incertidumbre de una calibración no lineal: Norma ISO 8466-2, GUM y Método de Monte Carlo</p></p>
</div>

<div class="d-byline">
  Carlos Gomez <a href="https://www.analytical.cl" class="uri">https://www.analytical.cl</a> 
  
<br/>2020-06-06
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<p>En un <a href="https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/">post anterior</a> revisamos cómo estimar la incertidumbre de la concentración de una muestra problema, cuando ésta ha sido obtenida interpolando la señal instrumental en una curva de calibración lineal.</p>
<p>La expresión es relativamente simple y vimos también cómo podemos implementarla en el lenguaje de programación <code>R</code> a través del package <code>chemCal</code>.</p>
<p>Sin embargo, la vida no es tan sencilla. Recoradará estimad@ lector@ que está bastante documentada la presencia de desviaciones de la linealidad a altas concentraciones, fenómeno muy conocido en los métodos espectrofotométricos (Ley de Lambert-Beer). La severidad de estas desviaciones varía en función del detector, el analito y otros factores físico-químicos del sistema de medición.</p>
<p>Cuando existen estas desviaciones y deseamos llevar a cabo un <a href="https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/">test de linealidad</a>, es muy probable que el test rechace el modelo lineal, por lo tanto, no podemos estimar la incertidumbre de calibración asumiendo este modelo. Si bien es cierto podemos reducir el rango lineal y diluir la muestra problema que está fuera del rango, la operación de dilución introduce nuevos errores (incluso errores humanos de transcripción bastante frecuentes).</p>
<p>Una alternativa válida sería utilizar un modelo de calibración que capture esta no linealidad evitando así la dilución de la muestra, por lo tanto el problema se reduce a:</p>
<blockquote>
<p>¿Cómo estimar la incertidumbre de una muestra problema que ha sido obtenida a través de una curva de calibración no lineal?</p>
</blockquote>
<p>Sin embargo, de esta pregunta se desprende al mismo tiempo otra interrogante:</p>
<blockquote>
<p>¿Cuál modelo de calibración no lineal utilizaré?</p>
</blockquote>
<p>Existen varios modelos de calibración no lineal:</p>
<ol type="1">
<li>Polinomios</li>
<li>New Rational (en realidad se llaman <em>aproximaciones de Padé</em>)</li>
<li>Splines</li>
<li>Loess</li>
<li>etc.</li>
</ol>
<p>Por lo tanto, no existe una respuesta completamente correcta desde la prespectiva estadística, pues un modelo cuadrático sería tan válido como un polinomio cúbico. Desde el punto de vista químico podríamos preguntarnos ¿qué sentido químico tiene una curva de calibración polinómica de grado 5? ¿Son interpretables los parámetros del modelo? En un modelo lineal como el de Lambert-Beer: <span class="math inline">\(y = \beta_{0} + \beta_{1}x\)</span> la pendiente de la curva de calibración tiene una interpretación química: es el producto entre coeficiente de extinción molar y la longitud de la celda:</p>
<p><span class="math display" id="eq:lambert">\[
\underbrace{A}_\text{y} = \underbrace{\epsilon \cdot b}_\text{$\beta_{1}$} \cdot
\underbrace{C}_\text{x}
\tag{1}
\]</span> Pero recuerde este sabio consejo de un monstruo de la estadística aplicada:</p>
<blockquote>
<p><em>“All models are wrong, but some are useful”</em> – <cite>George Box</cite></p>
</blockquote>
<p>Por lo tanto, tenemos que tomar una decisión. Y obviamente, como soy el autor de este humilde post, ya la tomé por Ud. En este artículo estimaremos la incertidumbre de calibración de un modelo polinómico de grado 2, también conocido como modelo cuadrático.</p>
<p>Nota: Desde el punto de vista <strong>estrictamente estadístico</strong> los modelos polinómicos, como la calibración cuadrática, son también modelos lineales ya que los coeficientes del modelo son lineales</p>
<p><span class="math display">\[y = \beta_{0} + \beta_{1}x + \beta_{2}x^2 + \epsilon\]</span></p>
<p>En cambio, en un modelo del tipo exponencial:</p>
<p><span class="math display">\[y = \beta_{0}\cdot e^{\beta_{1}x}\]</span></p>
<p>El coeficiente <span class="math inline">\(\beta_{1}\)</span> no es una función lineal.</p>
<h1 id="métodos-de-estimación-de-incertidumbre-de-calibración">Métodos de estimación de incertidumbre de calibración</h1>
<p>En este post ejemplificaremos y compararemos tres métodos de estimación de incertidumbre de calibración:</p>
<ol type="1">
<li><p>Norma ISO 8466-2:2001 <em>Water quality – Calibration and evaluation of analytical methods and estimation of performance characteristics – Part 2: Calibration strategy for non-linear second-order calibration functions.</em></p></li>
<li><p>Método GUM</p></li>
<li><p>Método de Monte Carlo (Suplemento 1 ISO-GUM)</p></li>
</ol>
<p>Implementaremos todos los métodos en el lenguaje de programación <code>R</code>, explicando paso a paso el código fuente con el fin de que Ud. obtenga los mismos resultados, es decir, un <strong>análisis reproducible</strong>.</p>
<h1 id="datos-de-calibración">Datos de calibración</h1>
<p>Para ejemplificar los cálculos, utilizaremos los datos de calibración indicados en el ejemplo de la sección 7 de la norma ISO 8466-2. El siguiente código <code>R</code> nos permite ingresar los datos manualmente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Ingresamos los datos de calibración de la sección 7 de la norma ISO 8466-2</span>
<span class='co'># x: concentración en mg/L</span>
<span class='co'># y: Absorbancia [UA]</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>18</span>, <span class='fl'>24</span>, <span class='fl'>30</span>, <span class='fl'>36</span>, <span class='fl'>42</span>, <span class='fl'>48</span>, <span class='fl'>54</span>, <span class='fl'>60</span>, <span class='fl'>66</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.083</span>, <span class='fl'>0.123</span>, <span class='fl'>0.164</span>, <span class='fl'>0.203</span>, <span class='fl'>0.240</span>, <span class='fl'>0.273</span>, <span class='fl'>0.303</span>, <span class='fl'>0.334</span>, <span class='fl'>0.364</span>, <span class='fl'>0.393</span><span class='op'>)</span>

<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='co'># creamos un data frame con las variables x e y (esto es</span>
                      <span class='co'># análogo a una matriz de datos en Excel con dos columnas)</span>
</code></pre>
</div>
</div>
<p>A continuación graficamos la curva de calibración con la librería <code>ggplot2</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span> <span class='co'># cargamos la librería ggplot2</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># esto es sólo por una cuestión estética del gráfico</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'red'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>'Concentración [mg/L]'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>'Absorbancia [UA]'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/unnamed-chunk-1-1.png" width="624" /></p>
</div>
<p>Mmm… no sé Ud. pero yo veo una leve curvatura. Como lo vimos en un <a href="https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/">post anterior</a> llevaremos a cabo un análisis estadístico básico para evaluar si el modelo de calibración lineal es adecuado, o si nos inclinamos por la hipótesis de no linealidad.</p>
<p>Como no tenemos replicados de cada punto de calibración, haremos un Test de Linealidad de Mandel. Lo primero, es ajustar un modelo lineal a los datos <span class="math inline">\(y = a + bx\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.lineal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span> <span class='co'># ajustamos un modelo lineal y lo guardamos </span>
                                  <span class='co'># con el nombre fit.lineal</span>

<span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>fit.lineal</span><span class='op'>)</span> <span class='co'># parameters::model_parameters() </span>
</code></pre>
</div>
<pre><code>Parameter   | Coefficient |       SE |       95% CI |  t(8) |      p
--------------------------------------------------------------------
(Intercept) |        0.03 | 5.83e-03 | [0.01, 0.04] |  4.29 | 0.003 
x           |    5.72e-03 | 1.37e-04 | [0.01, 0.01] | 41.80 | &lt; .001</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">                                         <span class='co'># simplemente nos ayuda</span>
                                         <span class='co'># a visualizar el análisis estadístico</span>
                                         <span class='co'># en una forma más ordenada</span>
</code></pre>
</div>
</div>
<p>Esta tabla nos dice que el intercepto del modelo es <span class="math inline">\(a = 0.0250303\)</span> y la pendiente <span class="math inline">\(b = 0.0057172\)</span>. Note el alto coeficiente de determinación <span class="math inline">\(r^{2} = 0.9954\)</span> lo cual indica que es un buen modelo. El coeficiente de correlación es <span class="math inline">\(r = 0.998\)</span> que si bien es un dato a considerar, no es una prueba formal de linealidad.</p>
<p>La siguiente figura muestra el ajuste lineal sobre los datos de calibración:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.r4photobiology.info/ggpmisc/'>ggpmisc</a></span><span class='op'>)</span> <span class='co'># para escribir ecuaciones dentro del gráfico</span>

<span class='fu'><a href='https://docs.r4photobiology.info/ggpmisc//reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'red'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span>, se <span class='op'>=</span> <span class='cn'>F</span>, 
              size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># dibuja la curva de calibración lineal</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>'Concentración [mg/L]'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>'Absorbancia [UA]'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://docs.r4photobiology.info/ggpmisc//reference/stat_poly_eq.html'>stat_poly_eq</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>stat</a></span><span class='op'>(</span><span class='va'>eq.label</span><span class='op'>)</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>stat</a></span><span class='op'>(</span><span class='va'>rr.label</span><span class='op'>)</span>, 
                                  sep <span class='op'>=</span> <span class='st'>"*\", \"*"</span><span class='op'>)</span><span class='op'>)</span>, 
               formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, 
               parse <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               rr.digits <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/plot.lineal-1.png" width="624" /></p>
</div>
<p>Se observa que el ajuste lineal no es un buen modelo, pues no captura la curvatura de los datos a pesar del alto coeficiente de correlación. Esto se oberva más claramente si obervamos el gráfico de residuos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit.lineal</span>, which <span class='op'>=</span> <span class='fl'>1</span>, add.smooth <span class='op'>=</span> <span class='cn'>F</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, col <span class='op'>=</span> <span class='st'>'red'</span>, 
     main <span class='op'>=</span> <span class='st'>'Gráfico de residuos modelo lineal'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/fit.lin.res-1.png" width="624" /></p>
</div>
<p>La evidencia en contra del modelo lineal es abrumadora, el gráfico muestra claramente un patrón en los residuos que indica que el modelo lineal no es adecuado. Sin embargo, a pesar de la evidencia, haremos el Test de Mandel para “comprobar” esta hipótesis. Para aplicar el Test de Mandel debemos ahora ajustar el modelo cuadrático y compararlo con el modelo lineal. Para ser consistentes en la notación de la norma ISO 8466-2, definiremos el modelo de calibración cuadrático como:</p>
<p><span class="math display">\[ 
y = a + bx + cx^2
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.nolineal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span> <span class='co'># ajuste cuadrático y los guardamos </span>
                                          <span class='co'># con el nombre fit.nolineal</span>
<span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter   | Coefficient |       SE |         95% CI |   t(7) |      p
-----------------------------------------------------------------------
(Intercept) |   -5.62e-03 | 2.47e-03 | [-0.01,  0.00] |  -2.27 | 0.057 
x           |    7.67e-03 | 1.42e-04 | [ 0.01,  0.01] |  54.01 | &lt; .001
x^2         |   -2.50e-05 | 1.79e-06 | [ 0.00,  0.00] | -14.01 | &lt; .001</code></pre>
</div>
<p>Se obtiene una tabla similar que la del modelo lineal, con la adición del coeficiente que acompaña al <span class="math inline">\(x^2\)</span>: <code>I(x^2)</code> <span class="math inline">\(= -2.504\times 10^{-5}\)</span>. Note que el coeficiente de determinación del modelo cuadrático es mayor que el del modelo lineal. Esto siempre se cumplirá, lo que hace el Test de Mandel es discernir si esta “mejora” en el modelo es “significativa”.</p>
<p>La siguiente figura muestra el ajuste no lineal, el cual captura mucho mejor la curvatura de los datos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://docs.r4photobiology.info/ggpmisc//reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'red'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span>,         <span class='co'># dibuja la curva de calibración no lineal</span>
              se <span class='op'>=</span> <span class='cn'>F</span>, 
              formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>'Concentración [mg/L]'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>'Absorbancia [UA]'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://docs.r4photobiology.info/ggpmisc//reference/stat_poly_eq.html'>stat_poly_eq</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>stat</a></span><span class='op'>(</span><span class='va'>eq.label</span><span class='op'>)</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>stat</a></span><span class='op'>(</span><span class='va'>rr.label</span><span class='op'>)</span>, 
                                  sep <span class='op'>=</span> <span class='st'>"*\", \"*"</span><span class='op'>)</span><span class='op'>)</span>,
               formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, 
               parse <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               rr.digits <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/plot.nolineal-1.png" width="624" /></p>
</div>
<p>Ok, aplicamos el Test de Mandel con el comando <code>anova</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>fit.lineal</span>, <span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter               |      RSS | Sum_Squares | df | df (error) | Mean_Square |      F |      p
--------------------------------------------------------------------------------------------------
Model 1: y ~ x          | 4.44e-04 |             |    |          8 |             |        |       
Model 2: y ~ x + I(x^2) | 1.53e-05 |    4.29e-04 |  1 |          7 |    4.29e-04 | 196.29 | &lt; .001</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>El p-value del test de Mandel es <span class="math inline">\(2.23\times 10^{-6}\)</span>, el cual de acuerdo a la interpretación tradicional, indica que el modelo lineal no es adecuado para los datos de calibración.</p>
<p>Procedamos, entonces, a estimar la incertidumbre de la concentración <span class="math inline">\(\hat{x}\)</span> de una muestra problema, cuyo valor fue obtenido interpolando la señal instrumental en el modelo de calibración no lineal.</p>
<h2 id="estimación-de-incertidumbre-de-acuerdo-a-iso-8466-2">Estimación de incertidumbre de acuerdo a ISO 8466-2</h2>
<p>Desde el punto de vista metrológico, la aproximación que indica esta norma es similar a lo que dicta la guía ISO GUM clásica, es decir, estima la incertidumbre a partir de un modelo de medición <span class="math inline">\(y = f(x)\)</span>. La “gracia” de esta norma es que nos ahorra tinta, pues la ecuación de incertidumbre ya está “algebraicamente manipulada”. No entraremos en los detalles de las primeras secciones de la norma los cuales estudian el comportamiento de la curvatura, es decir, si será posible encontrar un máximo o un mínimo, lo cual es clave en la utilidad del modelo cuadrático como función de calibración. Esto es importante porque recuerde que una función parabólica tiene dos soluciones, si existiera un máximo o un mínimo en el rango de trabajo, el modelo cuadrático no puede ser utilizado como función de calibración.</p>
<p>La siguiente ecuación calcula la <strong>incertidumbre expandida</strong> <span class="math inline">\(I(\hat{x}) = U_{\hat{x}}\)</span> de la concentración de la muestra problema <span class="math inline">\(\hat{x}\)</span>, interpolada en la curva de calibración no lineal <span class="math inline">\(y = a + bx + cx^2\)</span>. Corresponde a la ecuación (27) de la norma:</p>
<p><span class="math display">\[
I(\hat{x}) = \frac{s_{y} \cdot t_{n - 3,\, 95\%}}{b + 2c\hat{x}} \cdot
            \sqrt{\frac{1}{N} + \frac{1}{\hat{N}} + 
            \frac{(\hat{x} - \overline{x})^2 \, Q_{x^4} + 
            \left(\hat{x}^2 - \frac{\sum x_{i}^{2}}{N} \right)^2 Q_{xx} -
            2(\hat{x} - \overline{x}) 
            \left(\hat{x}^2 - \frac{\sum x_{i}^{2}}{N} \right) Q_{x^3}}
            {Q_{x^4} Q_{xx} - \left( Q_{x^3} \right)^2}}
\]</span></p>
<p>donde:</p>
<p><span class="math display">\[
s_{y} = \sqrt{\frac{\sum (y_{i} -\hat{y})^2}{N - 3}}
\]</span></p>
<ul>
<li><p><span class="math inline">\(y_{i}\)</span> es la respuesta experimental observada del estándar <span class="math inline">\(i\)</span>, <span class="math inline">\(\hat{y}\)</span> es la respuesta instrumental que predice el modelo para el mismo estándar <span class="math inline">\(i\)</span>, por lo tanto <span class="math inline">\(e_{i} = y_{i} - \hat{y}\)</span> es el residuo. <span class="math inline">\(N\)</span> es el número de calibrantes. ¿Por qué el denominador es <span class="math inline">\(N - 3\)</span> y no <span class="math inline">\(N -2\)</span> como en la calibración lineal? Porque el modelo cuadrático posee tres parámetros <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> y <span class="math inline">\(c\)</span>.</p></li>
<li><p><span class="math inline">\(t_{N - 3,\, 95\%}\)</span> es el valor del T de Student con <span class="math inline">\(N - 3\)</span> grados de libertad y un 95% de confianza.</p></li>
<li><p><span class="math inline">\(\hat{N}\)</span> es el número de replicados independientes de la muestra problema. Como discutimos en <a href="https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/">otro post</a>, esto no corresponde a inyectar <span class="math inline">\(\hat{N}\)</span> veces la misma muestra en el instrumento.</p></li>
<li><p><span class="math inline">\(\hat{x}\)</span> es la concentración de la muestra problema interpolada en la curva de calibración no lineal, la cual se obtiene resolviendo la ecuación cuadrática. Como Ud. recordará de sus años mozos esto siginifica que la concentración interpolada se obtiene a partir de:</p></li>
</ul>
<p><span class="math display">\[\hat{x} = \frac{-b \pm \sqrt{b^2 - 4(a - y_{0})c}}{2c}\]</span> donde <span class="math inline">\(y_{0}\)</span> es la señal instrumental de la muestra problema.</p>
<ul>
<li><p><span class="math inline">\(x_{i}\)</span> es la concentración del estándar <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\overline{x} = \sum_{i = 1}^{N} x_{i}\)</span> es el promedio de las concentraciones de los calibrantes.</p></li>
</ul>
<p>Finalmente:</p>
<p><span class="math display">\[
\begin{aligned}
Q_{xx}  &amp;= \sum x_{i}^2 - \frac{\left(\sum x_{i}\right)^2}{N} \\
Q_{x^3} &amp;= \sum x_{i}^3 - \left(\sum x_{i} \times \frac{\sum x_{i}^2}{N}\right) \\
Q_{x^4} &amp;= \sum x_{i}^4 - \frac{\left(\sum x_{i}^2\right)^2}{N}
\end{aligned}
\]</span></p>
<p>Ok, nada del otro mundo. Es bien fea, pero sólo son operaciones de aritmética básica. Algunas observaciones:</p>
<p>Como Ud. recordará en el caso de la calibración lineal, a partir de esta ecuación podemos inferir que si deseamos minimizar la incertidumbre de calibración no lineal podemos :</p>
<ol type="1">
<li>Aumentar el número de calibrantes <span class="math inline">\(N\)</span></li>
<li>Aumentar el número de replicados independientes de la muestra problema <span class="math inline">\(\hat{N}\)</span></li>
<li>Aumentar la sensibilidad del método, que en el caso de la calibración cuadrática está dada por <span class="math inline">\(b + 2c\hat{x}\)</span>, es decir, depende de la concentración de la muestra problema <span class="math inline">\(\hat{x}\)</span>. En cambio, en la calibración lineal la sensibilidad era constante en todo el rango de concentración estudiado y correspondía a la pediente de la curva.</li>
</ol>
<p>En el caso de la calibración lineal, la incertidumbre de calibración se minimiza en el centroide de la curva, en el caso del modelo cuadrático esto no siempre es así. Observe en la siguiente figura las bandas de confianza de ambos tipos de calibración:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="incertidumbre-no-lineal_files/figure-html5/patch-1.png" width="624" /></p>
</div>
<p>Advierta que ambos modelos comparten la propiedad que la mayor incertidumbre se encuentra en los extremos. Sin embargo, en la calibración cuadrática, para este conjunto de datos, la menor incertidumbre no está en el centro de la curva.</p>
<p>Ok, a continuación implementaremos la ecuación de incertidumbre en <code>R</code> con los datos del ejemplo de la sección 7 de la norma. La señal instrumental de la muestra problema es <span class="math inline">\(y_{0} = 0.084\)</span> UA:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># Número de calibrantes</span>
<span class='va'>N.hat</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>     <span class='co'># Número de replicados de la muestra problema</span>
<span class='va'>Qxx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>N</span>
<span class='va'>Qx3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>-</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>Qx4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>N</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>c</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>

<span class='va'>s.y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>$</span><span class='va'>sigma</span> <span class='co'># Es lo que R denomina Residual standard error</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span><span class='op'>(</span><span class='fl'>0.975</span>, <span class='va'>N</span> <span class='op'>-</span> <span class='fl'>3</span><span class='op'>)</span> <span class='co'># El T de Student (¡Ya no se usan tablas!)</span>

<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0.084</span> <span class='co'># Es la señal instrumental de la muestra problema</span>
<span class='va'>x.hat</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>b</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>4</span><span class='op'>*</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>-</span> <span class='va'>y0</span><span class='op'>)</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span> <span class='co'># Concentración de la muestra</span>

<span class='va'>Ix</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>s.y</span> <span class='op'>*</span> <span class='va'>t</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>b</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='va'>c</span><span class='op'>*</span><span class='va'>x.hat</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span>
  <span class='fl'>1</span><span class='op'>/</span><span class='va'>N</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>N.hat</span> <span class='op'>+</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>x.hat</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>Qx4</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>x.hat</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>Qxx</span> <span class='op'>-</span>  
  <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x.hat</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x.hat</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Qx3</span><span class='op'>)</span><span class='op'>/</span>
  <span class='op'>(</span><span class='va'>Qx4</span> <span class='op'>*</span> <span class='va'>Qxx</span> <span class='op'>-</span> <span class='va'>Qx3</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>Ix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='va'>Ix</span><span class='op'>)</span> <span class='co'># Simplemente es para dejar sólo el número</span>
</code></pre>
</div>
</div>
<p>La concentración de la muestra es <span class="math inline">\(\hat{x} = 12.17\)</span> mg/L. Al aplicar esta metodología obtenemos una incertidumbre expandida de <span class="math inline">\(I(\hat{x}) = 0.63\)</span> mg/L, es decir, exactamente la misma que la que indica la norma ISO. Note que si Ud. quisiera combinar esta incertidumbre de calibración con algún otro factor (p.ej: masa de la muestra, volumen de aforo, etc.) debe primero tansformarla en incertidumbre estándar, dividiéndola por el factor de cobertura <span class="math inline">\(k\)</span>, que en este caso corresponde al t Student con <span class="math inline">\(N - 3\)</span> grados de libertad al 95% de confianza (k = 2.36):</p>
<p><span class="math display">\[
u_{\hat{x}} = \frac{U_{\hat{x}}}{k} = 0.27\, \, \text{mg/L}
\]</span> Por lo tanto, si tuviéramos que informar el resultado de la concentración de la muestra interpolada en la curva de calibración no lineal informaríamos <span class="math inline">\(12.17 \pm 0.63\)</span> mg/L [<em>nota mental: mmmm… esto de las cifras significativas da para otro post, pero dejémoslo así por ahora. No olvidar borrar este comentario.</em>]</p>
<p>¿Cómo varía esta incertidumbre de calibración no lineal con la concentración de la muestra? La siguiente figura muestra esta variación:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>66</span>, by <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span> <span class='co'># Rango de concentración</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>N.hat</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>mu.x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># promedio de las concentraciones de los calibrantes</span>
<span class='va'>sq.x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'># suma de las concentraciones de los calibrantes al cuadrado</span>
<span class='va'>Qxx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>N</span>
<span class='va'>Qx3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>-</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>Qx4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>N</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span><span class='op'>(</span><span class='fl'>0.975</span>, <span class='va'>N</span> <span class='op'>-</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='co'># Para graficar la incertidumbre vs concentración, primero debemos crear una</span>
<span class='co'># función que tome un X (una concentración) y calcule el Y (incertidumbre)</span>
<span class='va'>Ux</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>U</span> <span class='op'>&lt;-</span> <span class='va'>s.y</span><span class='op'>*</span><span class='va'>t</span><span class='op'>/</span><span class='op'>(</span><span class='va'>b</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='va'>c</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span>
    <span class='fl'>1</span><span class='op'>/</span><span class='va'>N</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>N.hat</span> <span class='op'>+</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='va'>mu.x</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>Qx4</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='va'>sq.x</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>Qxx</span> <span class='op'>-</span>  
    <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='va'>mu.x</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='va'>sq.x</span><span class='op'>/</span><span class='va'>N</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Qx3</span><span class='op'>)</span><span class='op'>/</span>
    <span class='op'>(</span><span class='va'>Qx4</span> <span class='op'>*</span> <span class='va'>Qxx</span> <span class='op'>-</span> <span class='va'>Qx3</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Graficamos concentración (X) vs Incertidumbre (Y)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'>Ux</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>'n'</span>,
     main <span class='op'>=</span> <span class='st'>'Concentración vs Incertidumbre de calibración'</span>,
     xlab <span class='op'>=</span> <span class='st'>'Concentración [mg/L]'</span>,
     ylab <span class='op'>=</span> <span class='st'>'Incertidumbre expandida [mg/L]'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/splinefun.html'>spline</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'>Ux</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>'red'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/u.vs.con-1.png" width="624" /></p>
</div>
<p>Se aprecia que la incertidumbre aumenta con la concentración en una forma no constante para concentraciones mayores a 20 mg/L. Tal como mencionamos anteriormente, el mínimo no se encuentra en el centro del rango de concentración como ocurre con la calibración lineal. Para encontrar el valor exacto de concentración que minimiza la incertidumbre en este rango, usamos el comando <code>optimize</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Busca el mínimo de la función Ux en el intervalo de 12 a 66 mg/L</span>
<span class='fu'><a href='https://rdrr.io/r/stats/optimize.html'>optimize</a></span><span class='op'>(</span><span class='va'>Ux</span>, interval <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>66</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$minimum
[1] 20.29164

$objective
[1] 0.5808116</code></pre>
</div>
<p>La concentración que minimiza la incertidumbre es 20.29 mg/L.</p>
<p>Muy entretenido, pero la vida es corta y debemos ser eficientes por lo tanto, para evitarnos el “tedio” de implementar la fórmula a mano, utilizaremos el package <code>investr</code> el cual calcula exactamente la incertidumbre de calibración de un gran número de modelos de calibración, entre ellos, los modelos cuadráticos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># y0 es la señal de la muestra problema y0 = 0.084 UA</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bgreenwell/investr'>investr</a></span><span class='op'>)</span> <span class='co'># Cargamos la librería investr</span>
<span class='va'>x.hat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/investr/man/invest.html'>invest</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span>, data <span class='op'>=</span> <span class='va'>d</span>, y0 <span class='op'>=</span> <span class='va'>y0</span>, interval <span class='op'>=</span> <span class='st'>'Wald'</span><span class='op'>)</span>
<span class='va'>x.hat</span>
</code></pre>
</div>
<pre><code>  estimate      lower      upper         se 
12.1672952 11.5400416 12.7945488  0.2652656 </code></pre>
</div>
<p>donde:</p>
<ul>
<li><code>estimate</code> es la concentración de la muestra problema</li>
<li><code>upper</code> es el extremo superior de la incertidumbre expandida <span class="math inline">\(I(\hat{x})\)</span></li>
<li><code>lower</code> es el extremo inferior de la incertidumbre expandida <span class="math inline">\(I(\hat{x})\)</span></li>
<li><code>se</code> es la incertidumbre estándar de calibración <span class="math inline">\(u_{\hat{x}}\)</span>, la cual es exactamente igual a la obtenida por la fórmula anterior <span class="math inline">\(u_{\hat{x}} = \frac{U_{\hat{x}}}{k} = 0.27\, \, \text{mg/L}\)</span></li>
</ul>
<p>Note que si quisiéramos obener <span class="math inline">\(I(\hat{x})\)</span> a partir de esta tabla, tendríamos que hacer la siguiente operación <span class="math inline">\(I(\hat{x}) =\)</span> <code>upper</code> - <code>estimate</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x.hat</span><span class='op'>$</span><span class='va'>upper</span> <span class='op'>-</span> <span class='va'>x.hat</span><span class='op'>$</span><span class='va'>estimate</span>
</code></pre>
</div>
<pre><code>[1] 0.6272536</code></pre>
</div>
<p>No podemos usar el package <code>chemCal</code> que utilizamos en un <a href="https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/">post anterior</a> para estimar la incertidumbre de calibración, porque este package sólo soporta calibraciones lineales.</p>
<h2 id="estimación-de-incertidumbre-mediante-guía-iso-gum">Estimación de incertidumbre mediante Guía ISO GUM</h2>
<p>Ya que la señal instrumental es una función de la concentración, entonces, podemos utilizar la aproximación ISO GUM clásica para estimar la incertidumbre de calibración. Por “clásica” me refiero a utilizar la aproximación de Taylor con las derivadas parciales. Esta guía dice lo siguiente:</p>
<ol type="1">
<li>Expresar el mensurando como una ecuación de medición a través de una relación funcional con las magnitudes de entrada. En este caso el mensurando es la concentración <span class="math inline">\(\hat{x}\)</span> cuya ecuación de medición es la solución de la ecuación cuadrática <span class="math inline">\(y_{0} = a + b\hat{x} + c\hat{x^2}\)</span> donde <span class="math inline">\(y_{0}\)</span> es la señal de la muestra problema:</li>
</ol>
<p><span class="math display">\[
\hat{x} = \frac{-b \pm \sqrt{b^2 - 4(a - y_{0})c}}{2c}
\]</span> 2. Identificación de las fuentes de incertidumbre. Al observar la ecuación de medición identificamos las siguientes fuentes de incertidumbre:</p>
<ul>
<li>Parámetros del modelo cuadrático: <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> y <span class="math inline">\(c\)</span></li>
<li>Señal instrumental de la muestra problema <span class="math inline">\(y_{0}\)</span></li>
</ul>
<ol start="3" type="1">
<li>Evaluación de las fuentes de incertidumbre:</li>
</ol>
<ul>
<li>Las incertidumbres estándar de los parámetros del modelo pueden ser obtenidas directamente del ajuste cuadrático <code>fit.nolineal</code>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># parámetros del modelo</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>c</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>

<span class='co'># las incertidumbres estándar de a, b y c las obtenemos con la función summary</span>
<span class='va'>ua</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>]</span>
<span class='va'>ub</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>]</span>
<span class='va'>uc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<ul>
<li>La incertidumbre estándar de la señal instrumental de la muestra problema también puede obtenerse del ajuste cuadrático y corresponde a la desviación estándar residual:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>uy0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span><span class='op'>$</span><span class='va'>sigma</span>
<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0.084</span> <span class='co'># dato del problema, es decir, la absorbancia de la muestra</span>
</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Determinación de la incertidumbre estándar combinada <span class="math inline">\(u_{\hat{x}}\)</span> a través de la expresión:</li>
</ol>
<p><span class="math display">\[
u_{\hat{x}}^2 = \left( \frac{\partial{\hat{x}}}{\partial{y_{0}}}\right) ^{2} (u_{y_{0}})^{2} + 
\left( \frac{\partial{\hat{x}}}{\partial{a}}\right) ^{2} (u_{a})^{2} + 
\left( \frac{\partial{\hat{x}}}{\partial{b}}\right) ^{2} (u_{b})^{2} +
\left( \frac{\partial{\hat{x}}}{\partial{c}}\right )^{2} (u_{c})^{2}
\]</span></p>
<p>“sólo” nos falta obtener las derivadas parciales (aguante ese código <span class="math inline">\(\LaTeX\)</span>):</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial{\hat{x}}}{\partial{y_{0}}} &amp;= 
\frac{1}{\sqrt{b^{2} - 4c(a-y_{0})}} \\
\frac{\partial{\hat{x}}}{\partial{a}} &amp;=
  \frac{-1}{\sqrt{b^{2} - 4c(a-y_{0})}} \\
\frac{\partial{\hat{x}}}{\partial{b}} &amp;=
\frac{-1 + \frac{b}{\sqrt{b^{2} - 4c(a-y_{0})}}}{2c} \\
\frac{\partial{\hat{x}}}{\partial{c}} &amp;=
  \frac{-a + y_{0}}{c\sqrt{b^{2} - 4c(a-y_{0})}} - 
  \frac{-b + \sqrt{b^{2} - 4c(a-y_{0})}}{2c^{2}}
\end{aligned}
\]</span></p>
<p>¡Listo! ahora debemos evaluar las expresiones. Pero como soy flojo, prefiero usar el excelente package <code>metRology</code> que hará todo el trabajo por mí:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/metrology/'>metRology</a></span><span class='op'>)</span> <span class='co'># cargamos la librería</span>

<span class='va'>expr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>4</span><span class='op'>*</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>-</span> <span class='va'>y0</span><span class='op'>)</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># ecuación de medición</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='va'>a</span>, b <span class='op'>=</span> <span class='va'>b</span>, c <span class='op'>=</span> <span class='va'>c</span>, y0 <span class='op'>=</span> <span class='va'>y0</span><span class='op'>)</span> <span class='co'># valores de cada X input</span>
<span class='va'>u</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ua</span>, <span class='va'>ub</span>, <span class='va'>uc</span>, <span class='va'>uy0</span><span class='op'>)</span> <span class='co'># incertidumbres estándar de cada X input</span>
<span class='va'>u.GUM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/metRology/man/uncertainty.html'>uncert</a></span><span class='op'>(</span><span class='va'>expr</span>, <span class='va'>x</span>, <span class='va'>u</span>, method <span class='op'>=</span> <span class='st'>'GUM'</span><span class='op'>)</span> <span class='co'># Usamos el método GUM</span>
<span class='va'>u.GUM</span>
</code></pre>
</div>
<pre><code>
Uncertainty evaluation

Call:
  uncert.expression(obj = expr, x = x, u = u, method = &quot;GUM&quot;)

Expression: (-b + sqrt(b^2 - 4 * (a - y0) * c))/(2 * c)

Evaluation method:  GUM 

Uncertainty budget:
   x             u            c           u.c        
a  -5.621212e-03 2.474778e-03   -141.6217 -0.35048212
b   7.670455e-03 1.420320e-04  -1723.1492 -0.24474238
c  -2.504209e-05 1.787394e-06 -20966.0252 -0.03747454
y0  8.400000e-02 1.478563e-03    141.6217  0.20939648

   y:  12.16727
u(y):  0.4774807 </code></pre>
</div>
<p>¿What? ¿Por qué obtuvimos una incertidumbre estándar de 0.477 y no la que calculamos con la ecuación de la norma ISO 0.265? Por la sencilla razón de que los parámetros de un modelo cuadrático no son independientes, sus covarianzas no son 0. Es más, algunas de las covarianzas son negativas. Observe la siguiente figura que fue obtenida simulando curvas de calibración cuadráticas. En la figura se muestra las correlaciones entre los tres parámetros del modelo no lineal:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Simularemos p = 200 curvas de calibración cuadráticas a partir de los datos </span>
<span class='co'># empíricos </span>

<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>200</span> <span class='co'># Número de simulaciones</span>
<span class='va'>a.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='co'># vector que guardará el parámetro a</span>
<span class='va'>b.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='co'># vector que guardará el parámetro b</span>
<span class='va'>c.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='co'># vector que guardará el parámetro c</span>

<span class='co'># Hacemos un loop</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>x.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>66</span>, by <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
  <span class='va'>y.sim</span> <span class='op'>&lt;-</span> <span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span><span class='op'>*</span><span class='va'>x.sim</span> <span class='op'>+</span> <span class='va'>c</span><span class='op'>*</span><span class='va'>x.sim</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x.sim</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>uy0</span><span class='op'>)</span>
  <span class='va'>fit.nolineal.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y.sim</span> <span class='op'>~</span> <span class='va'>x.sim</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x.sim</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>a.sim</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal.sim</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>b.sim</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal.sim</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>c.sim</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>fit.nolineal.sim</span><span class='op'>$</span><span class='va'>coeff</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='co'># guardamos los parámetros simulados en un data frame que llamamos param.sim</span>
<span class='va'>param.sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>a.sim</span>, <span class='va'>b.sim</span>, <span class='va'>c.sim</span><span class='op'>)</span> 
                                                
<span class='co'># graficamos los parámetros simulados</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>param.sim</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>Se advierte claramente que existe una correlación negativa entre los parámetros <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>, además entre <span class="math inline">\(b\)</span> y <span class="math inline">\(c\)</span>. La correlación entre <span class="math inline">\(a\)</span> y <span class="math inline">\(c\)</span> es positiva. En rigor, habría que incorporar las derivadas parciales cruzadas y las covarianzas entre los parámetros. De sólo pensarlo, me dan ganas de procastinar aún más la escritura de este post, así que recurriremos al package <code>metRology</code>.</p>
<p>La parte “fácil” es obtener la matriz de covarianzas de los parámetros del modelo con el comando <code>vcov</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span><span class='op'>(</span><span class='va'>fit.nolineal</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a'</span>, <span class='st'>'b'</span>, <span class='st'>'c'</span><span class='op'>)</span> <span class='co'># solo cosmética para que aparezcan los nombres</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a'</span>, <span class='st'>'b'</span>, <span class='st'>'c'</span><span class='op'>)</span> <span class='co'># de los parámetros (es opcional)</span>
<span class='va'>v</span>
</code></pre>
</div>
<pre><code>              a             b             c
a  6.124524e-06 -3.337187e-07  3.910406e-09
b -3.337187e-07  2.017310e-08 -2.491926e-10
c  3.910406e-09 -2.491926e-10  3.194776e-12</code></pre>
</div>
<p>La diagonal de esta matriz es precisamente la incertidumbre estándar al cuadrado de los parámetros (a.k.a sus varianzas). Si queremos, también podemos expresarla como matriz de correlaciones con el comando <code>cov2cor</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>param.cor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
<span class='va'>param.cor</span>
</code></pre>
</div>
<pre><code>           a          b          c
a  1.0000000 -0.9494193  0.8840269
b -0.9494193  1.0000000 -0.9815865
c  0.8840269 -0.9815865  1.0000000</code></pre>
</div>
<p>En la diagonal de esta matriz obviamente esperamos correlación 1. Se observa claramente la alta correlación entre los parámetros, como dijimos anteriormente, algunas de ellas son negativas.</p>
<p>La parte “difícil” es que debemos incorporar la variable señal instrumental de la muestra problema <span class="math inline">\(y_{0}\)</span>, la cual obviamente es independiente de los parámetros del modelo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Incorporamos la variable y0 que es independiente de los parámetros</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/metRology/man/rbind.ilab.html'>rbind</a></span><span class='op'>(</span><span class='va'>v</span>, y0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> 
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/metRology/man/rbind.ilab.html'>cbind</a></span><span class='op'>(</span><span class='va'>v</span>, y0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>v</span><span class='op'>[</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>uy0</span><span class='op'>^</span><span class='fl'>2</span> <span class='co'># Asignamos al elemento de la 4a fila y 4a columna  </span>
                 <span class='co'># la varianza de y0</span>
<span class='va'>v</span>
</code></pre>
</div>
<pre><code>               a             b             c           y0
a   6.124524e-06 -3.337187e-07  3.910406e-09 0.000000e+00
b  -3.337187e-07  2.017310e-08 -2.491926e-10 0.000000e+00
c   3.910406e-09 -2.491926e-10  3.194776e-12 0.000000e+00
y0  0.000000e+00  0.000000e+00  0.000000e+00 2.186147e-06</code></pre>
</div>
<p>Ahora, incorporamos las covarianzas en el cálculo por método GUM:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>u.GUM.cov</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/metRology/man/uncertainty.html'>uncert</a></span><span class='op'>(</span><span class='va'>expr</span>, <span class='va'>x</span>, cov <span class='op'>=</span> <span class='va'>v</span>, method <span class='op'>=</span> <span class='st'>"GUM"</span><span class='op'>)</span>
<span class='va'>u.GUM.cov</span>
</code></pre>
</div>
<pre><code>
Uncertainty evaluation

Call:
  uncert.expression(obj = expr, x = x, method = &quot;GUM&quot;, cov = v)

Expression: (-b + sqrt(b^2 - 4 * (a - y0) * c))/(2 * c)

Evaluation method:  GUM 

Uncertainty budget:
   x             u            c           u.c        
a  -5.621212e-03 2.474778e-03   -141.6217 -0.35048212
b   7.670455e-03 1.420320e-04  -1723.1492 -0.24474238
c  -2.504209e-05 1.787394e-06 -20966.0252 -0.03747454
y0  8.400000e-02 1.478563e-03    141.6217  0.20939648

   y:  12.16727
u(y):  0.2651904 </code></pre>
</div>
<p>¡Perfecto!, ahora sí, al incluir las covarianzas obtenemos resultados consistentes con el método descrito en la norma ISO 8466-2.</p>
<h2 id="estimación-con-el-método-de-monte-carlo">Estimación con el Método de Monte Carlo</h2>
<p>No detallaremos aquí cómo funciona el método de Monte Carlo, puede consultarlo en <a href="https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/">este post</a> y en <a href="https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/">este otro</a>.</p>
<p>Sería super simple si usamos el package <code>metRology</code>, el problema es que el package lanza un error numérico cuando existen covarianzas negativas. Probé el ejemplo que incluye el manual de <code>metRology</code> y el error se repite. Es un problema al evaluar la suma de las correlaciones. Le consulté al autor Steve Ellison, sin embargo, a la fecha (09 de junio 2020) aún no tengo respuesta, a pesar de que Steve siempre responde las consultas en forma muy expedita. Otros usuarios han tenido un problema similar y se ha abierto un hilo en <a href="https://stackoverflow.com/questions/60971950/error-in-eigensigma-symmetric-true-0-x-0-matrix-in-metrology-uncertmc-wit/62119518#62119518">stackoverflow</a>.</p>
<p>Por lo tanto, implementamos el método de Monte Carlo “a mano” utilizando el package <code>MASS</code> el cual permite generar muestras aleatorias multivariadas incluyendo las correlaciones:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># No funciona metRology MC así que lo hicimos a mano</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span> <span class='co'># cargamos la librería</span>

<span class='co'># Generamos n muestras aleatorias multivariadas, cuyas medias </span>
<span class='co'># corresponden a los valores de a, b, c e y0</span>
<span class='co'># La matriz de covarianza Sigma = v la calculamos anteriormente</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span> <span class='co'># Para que Ud. obtenga los mismos resultados</span>
<span class='va'>muestra.MC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10000</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span>, <span class='va'>c</span>, <span class='va'>y0</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='va'>v</span>, empirical <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a'</span>, <span class='st'>'b'</span>, <span class='st'>'c'</span>, <span class='st'>'y0'</span><span class='op'>)</span> <span class='co'># solo cosmética</span>
<span class='va'>muestra.MC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>)</span> <span class='co'># lo guardamos como data.frame</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>)</span> <span class='co'># muestra las primeras n = 6 simulaciones</span>
</code></pre>
</div>
<pre><code>             a           b             c         y0
1 -0.004872147 0.007615757 -2.422806e-05 0.08771566
2 -0.004584974 0.007614935 -2.439880e-05 0.08385741
3 -0.005903886 0.007685426 -2.569142e-05 0.08643112
4 -0.004770996 0.007561121 -2.367442e-05 0.08417975
5 -0.003113309 0.007559284 -2.403774e-05 0.08478106
6 -0.006100136 0.007724920 -2.626908e-05 0.08644533</code></pre>
</div>
<p>Cada fila es una simulación. Si, por ejemplo, calculamos el promedio de cada variable simulada, obtenemos un valor similar a los valores empíricos. A mayor número de simulaciones, más nos acercamos a valores que asumimos como verdaderos.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>muestra.MC</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span> <span class='co'># promedio de cada columna</span>
</code></pre>
</div>
<pre><code>            a             b             c            y0 
-5.621212e-03  7.670455e-03 -2.504209e-05  8.400000e-02 </code></pre>
</div>
<p>Bien, lo que tenemos que hacer es que en cada simulación debemos calcular la concentración de la muestra:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># cargaré estas librerías sólo para facilitar la manipulación de los datos</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>

<span class='co'># Creamos una nueva variable llamada x.hat que corresponde a la concentración de</span>
<span class='co'># la muestra</span>
<span class='va'>muestra.MC</span> <span class='op'>&lt;-</span> <span class='va'>muestra.MC</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>x.hat <span class='op'>=</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>b</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>4</span><span class='op'>*</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>-</span> <span class='va'>y0</span><span class='op'>)</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>c</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>)</span> <span class='co'># muestra las primeras n = 6 simulaciones</span>
</code></pre>
</div>
<pre><code>             a           b             c         y0    x.hat
1 -0.004872147 0.007615757 -2.422806e-05 0.08771566 12.66792
2 -0.004584974 0.007614935 -2.439880e-05 0.08385741 12.08205
3 -0.005903886 0.007685426 -2.569142e-05 0.08643112 12.53997
4 -0.004770996 0.007561121 -2.367442e-05 0.08417975 12.23276
5 -0.003113309 0.007559284 -2.403774e-05 0.08478106 12.09232
6 -0.006100136 0.007724920 -2.626908e-05 0.08644533 12.51252</code></pre>
</div>
<p>La última columna corresponde a la concentración calculada para cada simulación. Por lo tanto, si queremos obtener la incertidumbre estándar de la concentración, basta calcular la desviación estándar de esa columna:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mu.x.hat.MC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>$</span><span class='va'>x.hat</span><span class='op'>)</span> <span class='co'># valor promedio de concentración</span>
<span class='va'>u.x.hat.MC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>$</span><span class='va'>x.hat</span><span class='op'>)</span> <span class='co'># incertidumbre estándar de la concentración</span>
<span class='va'>u.x.hat.MC</span>
</code></pre>
</div>
<pre><code>[1] 0.265321</code></pre>
</div>
<p>Se obtiene una incertidumbre estándar de calibración de 0.265 mg/L, la cual es consistente con los otros métodos estudiados. La siguiente figura muestra el histograma de las concentraciones simuladas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>muestra.MC</span><span class='op'>$</span><span class='va'>x.hat</span>, 
     breaks <span class='op'>=</span> <span class='fl'>20</span>,
     main <span class='op'>=</span> <span class='st'>'Concentraciones simuladas por Monte Carlo'</span>,
     xlab <span class='op'>=</span> <span class='st'>'Concentración [mg/L]'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="incertidumbre-no-lineal_files/figure-html5/plot.u.MC-1.png" width="624" /></p>
</div>
<p>Finalmente, la siguiente tabla resume los resultados de los tres métodos considerando la incertidumbre estándar de calibración:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tabla</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>Ix</span><span class='op'>/</span><span class='va'>t</span>, <span class='va'>u.GUM</span><span class='op'>$</span><span class='va'>u.y</span>, <span class='va'>u.GUM.cov</span><span class='op'>$</span><span class='va'>u.y</span>, <span class='va'>u.x.hat.MC</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>tabla</span>, 
             rownames <span class='op'>=</span> <span class='cn'>NA</span>,
             col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'ISO'</span>, <span class='st'>'GUM'</span>, <span class='st'>'GUM/Covarianzas'</span>, <span class='st'>'Monte Carlo'</span><span class='op'>)</span>,
             align <span class='op'>=</span> <span class='st'>'l'</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">ISO</th>
<th style="text-align: left;">GUM</th>
<th style="text-align: left;">GUM/Covarianzas</th>
<th style="text-align: left;">Monte Carlo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.2651904</td>
<td style="text-align: left;">0.4774807</td>
<td style="text-align: left;">0.2651904</td>
<td style="text-align: left;">0.265321</td>
</tr>
</tbody>
</table>
</div>
<p>Se aprecia claramente una excelente concordancia entre los tres métodos. Sin embargo, para que el método GUM entregue resultados correctos, es necesario incorporar las covarianzas entre las variables input.</p>
<p>En un próximo post exploraremos el método <em>Bootstrap</em>, un método estadístico por excelencia para estimar incertidumbre sin utilizar un modelo de medición…</p>
<blockquote>
<p>¡Dejad que los datos hablen!</p>
</blockquote>
<h1 id="bibliografía">Bibliografía</h1>
<ol type="1">
<li><p>Norma ISO 8466-2:2001 <em>Water quality – Calibration and evaluation of analytical methods and estimation of performance characteristics – Part 2: Calibration strategy for non-linear second-order calibration functions.</em></p></li>
<li><p>Brandon M. Greenwell and Christine M. Schubert Kabban (2014). investr: An R Package for Inverse Estimation. The R Journal, 6(1), 90-100. URL <a href="http://journal.r-project.org/archive/2014-1/greenwell-kabban.pdf" class="uri">http://journal.r-project.org/archive/2014-1/greenwell-kabban.pdf</a>.</p></li>
<li><p>NIST/SEMATECH e-Handbook of Statistical Methods, <em>Uncertainty for quadratic calibration using propagation of error</em>, <a href="https://www.itl.nist.gov/div898/handbook/mpc/section3/mpc3671.htm" class="uri">https://www.itl.nist.gov/div898/handbook/mpc/section3/mpc3671.htm</a>, 09 de junio 2020.</p></li>
<li><p>Nonlinear multivariate calibration methods in analytical chemistry Sonja Sekulic, Mary Beth Seasholtz, Ziyi Wang, Bruce R. Kowalski, Samuel E. Lee, and Bradley R. Holt <em>Analytical Chemistry 1993 65 (19), 835A-845A</em></p></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
